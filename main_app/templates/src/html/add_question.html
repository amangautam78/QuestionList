{% extends 'src/html/base.html' %}
{% load static %}
{% block content %}
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<style type="text/css">
#editor-container {
  height: 250px;
  background-color: white;
}
#editor-container-explaination {
  height: 200px;
  background-color: white;
}

.correct-answer {
    background-color: #13deb9; /* Green color */
}
</style>

<div class="container-fluid">
  <section class="content">
    <div class="container">
      <div class="card">
        <div id="editor-container">
        </div>
        <!-- Add submit button -->
        
      </div>

      <div class="card" style="padding: 20px;">
      <h6 style="padding-bottom: 10px;">Add Options</h6>
      <div id="form-placeholder"></div>
      <button id="btn-add" class="btn btn-outline-primary m-1 rounded-circle" style="width: 50px; height: 50px;">+</button>

    </div>
     <div class="card">
        <div id="editor-container-explaination">
        </div>
        <!-- Add submit button -->
        
      </div>

      <button id="submitBtn" class="btn btn-primary" style="float: right;">Submit</button>
    </div>
  </section>
</div>


<script>


function toggleRowColor(checkbox) {
    var row = checkbox.closest('.option-row');
    if (checkbox.checked) {
        row.classList.add('correct-answer');
    } else {
        row.classList.remove('correct-answer');
    }
}


var quill = new Quill('#editor-container', {
  modules: {
    toolbar: [
      [{ header: [1, 2, false] }],
      ['bold', 'italic', 'underline'],
      ['image', 'code-block']
    ]
  },
  placeholder: 'Compose a question...',
  theme: 'snow'  // or 'bubble'
});

var quill = new Quill('#editor-container-explaination', {
  modules: {
    toolbar: [
      [{ header: [1, 2, false] }],
      ['bold', 'italic', 'underline'],
      ['image', 'code-block']
    ]
  },
  placeholder: 'Compose an explaination...',
  theme: 'snow'  // or 'bubble'
});

// Function to handle form submission
function handleSubmit() {
  // Get the HTML content from the Quill editor
  var content = document.querySelector('.ql-editor').innerHTML;
  // Make AJAX call to send the content to the backend
  $.ajax({
    url: '/add-question/', // Replace with your Django endpoint
    method: 'POST',
    data: { content: content },
    success: function(response) {
      console.log('Content saved successfully:', response);
    },
    error: function(xhr, status, error) {
      console.error('Error saving content:', error);
    }
  });
}

// Attach click event listener to the submit button
document.getElementById('submitBtn').addEventListener('click', handleSubmit);


function appendUserRow(id, user) {
            var html = `<div id="opt-row.${id}" class="form-group row option-row" style="margin-bottom: 10px; padding: 10px;">
    <div class="col-12 col-md-2">
        <label for="opt-no.${id}" class="col-form-label">(${id})</label>
    </div>

    <div class="col-12 col-md-6">
        <input required type="text" class="form-control" id="opt-name.${id}" name="opt-name.${id}" placeholder="Option" value="${user.name}">
    </div>

    <div class="col-6 col-md-2">
        <div class="form-check">
            <input class="form-check-input" type="checkbox" id="correct-answer-${id}" name="correct-answer-${id}" onchange="toggleRowColor(this)">
            <label class="form-check-label" for="correct-answer-${id}">
                Correct
            </label>
        </div>
    </div>

    <div class="col-6 col-md-2">
        <i class="ti ti-trash col-form-label" onclick="delRow(${id})" style="float: right;"></i>
    </div>
</div>

`;
            $("#form-placeholder").append(html);
        }

function delRow(id) {
            var element = document.getElementById("opt-row." + id);
            element.parentNode.removeChild(element);
        }

$(document).ready(function () {
            var count = 1;
$("#btn-add").click(function () {
                appendUserRow(count++, {
                    name: "",
                })
            });
});



</script>

{% endblock %}
